# 慢查询分析

在 DBA 的日常工作中，需要对集群的查询语句执行情况进行分析和治理，NebulaGraph Dashboard 支持查看慢查询的情况，包括语句、耗时、类型、执行计划等。

## 功能介绍

- 展示当前执行中的慢查询信息。可以根据关键词、图空间筛选慢查询。
- 展示慢查询历史记录。可以根据关键词、图空间、语句类型、时间范围筛选记录。

## 前提条件

NebulaGraph 的 Graph 配置文件中，已设置`enable_record_slow_query`=`true`。详情参见 [Graph 服务配置](../../../5.configurations-and-logs/1.configurations/3.graph-config.md)。

## 入口

1. 在 Dashboard 企业版顶部导航栏，单击**集群管理**。
2. 单击目标集群右侧的**详情**。
3. 在左侧导航栏，单击**分析诊断**->**慢查询分析**。

## 查看当前慢查询

单击**当前查询**标签，会展示正在执行的慢查询。参数说明如下。

|参数|说明|
|:--|:--|
|语句|慢查询的语句。|
|持续时间（μs）|慢查询已经执行的时长。|
|开始时间|慢查询开始执行的时间。|
|状态|慢查询的状态。包括`running`和`killing`。|
|用户名|执行查询的用户名。|
|主机名|用户连接的服务器地址和端口。|
|操作|支持终止慢查询。|

## 查看慢查询历史记录

单击**历史查询**标签，会展示慢查询历史记录。参数说明如下。

|参数|说明|
|:--|:--|
|语句|慢查询的语句。|
|累计耗时（μs）|慢查询执行的时长。|
|语句类型|慢查询语句的类型，包括`DDL`、`DQL`、`DML`、`DCL`、`UTIL`和`UNKNOWN`。|
|图空间|执行慢查询的图空间名称。|
|记录时间|将语句作为慢查询记录到内存中的时间。|
|操作|支持查看执行计划，方便 DBA 根据执行计划优化慢查询语句。|

!!! note

    关闭慢查询记录功能**不会**清空慢查询历史记录。